php_version: "8.2"
php_packages_state: latest
php_use_managed_ini: true
php_memory_limit: "512M"
php_max_execution_time: "90"
php_upload_max_filesize: "256M"
php_packages:
  - php8.2-apcu
  - php8.2-common
  - php8.2-intl
  - php8.2-cli
  - php8.2-dev
  - php8.2-fpm
  - libpcre3-dev
  - php8.2-gd
  - php8.2-curl
  - php8.2-imap
  - php8.2-json
  - php8.2-mbstring
  - php8.2-opcache
  - php8.2-pdo
  - php8.2-xml
  - php8.2-zip
  - php8.2-mysql
php_date_timezone: "UTC"
php_webserver_daemon: "nginx"
php_fpm_daemon: php8.2-fpm
php_conf_paths:
  - /etc/php/8.2/fpm
  - /etc/php/8.2/cli
php_extension_conf_paths:
  - /etc/php/8.2/fpm/conf.d
  - /etc/php/8.2/cli/conf.d

mysql_packages:
  - mariadb-client
  - mariadb-server
  - python3-mysqldb

mysql_root_password: "{{ mysql_root_password }}"
mysql_databases:
  - name: "{{ database_name }}"
    encoding: utf8mb4
    collation: utf8mb4_unicode_ci
mysql_users:
  - name: "{{ database_user }}"
    host: "%"
    password: "{{ database_user_password }}"
    priv: "{{ database_name }}.*:ALL"

nginx_server_names_hash_bucket_size: "128"
nginx_remove_default_vhost: true
nginx_vhosts:
  - listen: "80 default_server"
    server_name: "{{ domain }}"
    root: "/var/www/{{ domain }}/current/public"
    index: "index.php index.html index.htm"
    state: "present"
    template: "{{ nginx_vhost_template }}"
    extra_parameters: |
      location / {
          try_files $uri $uri/ /index.php$is_args$args;
      }
      location ~ \.php$ {
          fastcgi_split_path_info ^(.+\.php)(/.+)$;
          fastcgi_pass unix:/var/run/php/php8.2-fpm.sock;
          fastcgi_index index.php;
          fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
          include fastcgi_params;
      }

certbot_auto_renew_user: root
certbot_auto_renew_minute: 20
certbot_auto_renew_hour: 5

composer_global_packages:
  - { name: laravel/installer }
composer_home_path: '/home/{{ web_user }}/.composer'
composer_home_owner: "{{ web_user }}"
composer_home_group: www-data
composer_add_to_path: true

nodejs_npm_global_packages:
  - name: yarn
  - name: npm